# 应用层归纳

### 应用层

* 应用层为特定应用程序提供数据传输服务。
* 应用层基本单位为报文。
* 应用层常用的协议有：HTTP，DNS，FTP，SMTP等等。



### DNS

* DNS（域名系统）提供主机名和IP地址间的**相互转换**，它结构上属于分布式数据库，存储域名和对应的IP地址。
* 基于UDP或者TCP协议，服务器端口号为53。
  * 一般用UDP，要求服务器自己处理超时和重传。
  * 少数情况用TCP，因为：
    * UDP最大只支持512字节数据，所以响应超过512字节就不能再用UDP。
    * 区域传送。



### DHCP

即动态主机配置协议，可以自动配置接入主机的IP地址，子网掩码等信息。原理是通过客户端的68号端口向DHCP服务器的67号端口建立UDP连接。UDP的应用比较少，除了DNS和DHCP外基本都是TCP了。



### FTP

* FTP（文件传送协议）负责传输文件，上传或者下载。
* 基于TCP，需要建立两个连接。
  * 控制连接：由客户端主动建立连接到服务器的21号端口，然后客户端就可以发送控制指令给服务器，服务器响应。
  * 数据连接：传输文件数据。一般用主动模式，即服务器的20号端口主动建立连接，然后发送/接收客户端的数据。



### SMTP

首先简单了解一下电子邮件系统：

* 发送人用户代理 -> 发送方邮件服务器 ->  接收方邮件服务器 -> 收件人用户代理
* 发送协议用SMTP，读取协议用POP3和IMAP。

SMTP通过SMTP客户端主动向SMTP服务器的25号端口建立TCP连接，从而实现邮件内容的传输。SMTP本身只能发送ASCII码（7位），但是可以通过MIME（多用途互联网邮件扩展）发送二进制文件。MIME相当于一种编码标准，可以实现用户的非ASCII码和ASCII码间的互相转换。

POP3和IMAP也是基于TCP的。



### HTTP

客户端（浏览器）通过和Web服务器的80端口建立TCP连接，用于传输网页（html）等静态资源。







